# https://hydra.cc/docs/configure_hydra/intro/
# poetry add hydra-submitit-launcher

# enable color logging
defaults:
  - override hydra_logging: colorlog
  - override job_logging: colorlog
  - override launcher: submitit_slurm

# output directory, generated dynamically on each run
run:
  dir: ${paths.log_dir}/${task_name}/runs/${now:%Y-%m-%d}_${now:%H-%M-%S}
sweep:
  dir: ${paths.log_dir}/${task_name}/multiruns/${now:%Y-%m-%d}_${now:%H-%M-%S}
  subdir: ${hydra.job.num}

launcher:
  # @package hydra.launcher
  submitit_folder: ${hydra.sweep.dir}/.submitit/%j
  timeout_min: 20
  cpus_per_task: 10
  nodes: 4
  name: ${hydra.job.name}
  partition: prepost
  account: oha@v100
  _target_: hydra_plugins.hydra_submitit_launcher.submitit_launcher.SlurmLauncher
  gres: gpu:4
